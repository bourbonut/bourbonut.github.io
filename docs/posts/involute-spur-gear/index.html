<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Benjamin Bourbon">
<meta name="dcterms.date" content="2023-01-08">

<title>Blog - Spur Tooth Profile</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Benjamin Bourbon</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bourbonut"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/benjamin-bourbon-84a6751b8/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Spur Tooth Profile</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">mechanic</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Benjamin Bourbon </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 8, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Involute gears are the most popular power transmission devices. We find them as an essential component for many machines. For instance, epicyclic gear train is a combination of gears which allows to make a reduction in a compact way. Spur gears are the most popular form and the most efficient type of gearing.</p>
<section id="involute-function" class="level1">
<h1>Involute function</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="force.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure : Transmission of torque</figcaption><p></p>
</figure>
</div>
<p>In order to maximize the transmission effort, we introduce the involute function. This function is defined as we roll a rope up around a circle. Then the rope is rolled out while being tight such that its direction is tangent to the circle. The trajectory of the end point of the rope describes follows the involute function.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><video src="InvoluteFunction.mp4" class="img-fluid" controls=""><a href="InvoluteFunction.mp4">Video</a></video></p>
<p></p><figcaption class="figure-caption">Animation : Involute Function</figcaption><p></p>
</figure>
</div>
<p>Now, all variables are defined on the following figure :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="static_involute.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure : Variables for Involute Function</figcaption><p></p>
</figure>
</div>
<p>Then we can easily see the formula of the involute function <span class="math inline">\(\vec \theta(r, t)\)</span>: <span class="math display">\[
\vec \theta(r, t) = r \ \vec u(t) - r t \ \vec v(t) = r \begin{pmatrix} \cos(t) + t \sin(t) \\ \sin(t) - t \cos(t) \end{pmatrix}
\]</span></p>
<p>By adding a starting angle, the involute function can be written as : <span class="math display">\[
\boxed{\vec \theta(r, t, t_0) = r \ \vec u(t - t_0) - r t \ \vec v(t - t_0) = r \begin{pmatrix} \cos(t - t_0) + t \sin(t - t_0) \\ \sin(t - t_0) - t \cos(t - t_0) \end{pmatrix}}
\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pip install PyGLM</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> glm <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> maths <span class="im">import</span> cos, sin</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> u(t):</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vec3(cos(t), sin(t), <span class="dv">0</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> v(t):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vec3(<span class="op">-</span>sin(t), cos(t), <span class="dv">0</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> involute(t, r, t0<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r <span class="op">*</span> (u(t <span class="op">-</span> t0) <span class="op">-</span> t <span class="op">*</span> v(t <span class="op">-</span> t0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note: for <code>glm</code>, see <a href="see https://github.com/Zuzu-Typ/PyGLM">PyGLM</a>.</p>
</section>
<section id="dimension-of-a-tooth" class="level1">
<h1>Dimension of a tooth</h1>
<p>There are several dimensions that are normalized in industry :</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
<th>Relation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(m\)</span></td>
<td>the module</td>
<td>Fundamental variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(z\)</span></td>
<td>the number of teeth</td>
<td>Fundamental variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td>the pressure angle</td>
<td>Fundamental variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(k_a\)</span></td>
<td>the addendum coefficient usually <span class="math inline">\(k_a = 1\)</span></td>
<td>Fundamental variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(k_f\)</span></td>
<td>the dedendum coefficient usually <span class="math inline">\(k_f = 1.25\)</span></td>
<td>Fundamental variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(h_a\)</span></td>
<td>the addendum height</td>
<td><span class="math inline">\(h_a = k_a m\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(h_f\)</span></td>
<td>the dedendum height</td>
<td><span class="math inline">\(h_f = k_f m\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_p\)</span></td>
<td>the pitch radius</td>
<td><span class="math inline">\(r_p = \frac{mz}{2}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_b\)</span></td>
<td>the base radius</td>
<td><span class="math inline">\(r_b = r_p \cos(\alpha)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_a\)</span></td>
<td>the addendum radius</td>
<td><span class="math inline">\(r_a = r_p + h_a\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_f\)</span></td>
<td>the dedendum radius</td>
<td><span class="math inline">\(r_f = r_p - h_f\)</span></td>
</tr>
</tbody>
</table>
<p>We can start with a simple gear profile :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gear_without_interference.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure: Gear Profile with dimensions</figcaption><p></p>
</figure>
</div>
<p>On this figure :</p>
<ul>
<li>The red circle is the <strong>pitch circle</strong>.</li>
<li>The yellow circle is the <strong>base circle</strong>.</li>
<li>The blue inner circle is the <strong>dedendum circle</strong>.</li>
<li>The blue outer circle is the <strong>addendum circle</strong>.</li>
</ul>
<p>We saw that the involute function starts from <span class="math inline">\(t_0\)</span> with the base radius <span class="math inline">\(r_b\)</span>. But we also need to know when the involute function stops. To get this information, we must find <span class="math inline">\(t\)</span> when <span class="math inline">\(\Vert \vec \theta(r_b, t, t_0) \Vert = r_a\)</span>. <span class="math display">\[
\begin{align}
    \Vert \vec \theta(r_b, t, t_0) \Vert^2 &amp; =  r_b^2 \left[ \cos(t - t_0) + t \sin(t - t_0)  \right]^2 + \left[ \sin(t - t_0) - t \cos(t - t_0)  \right]^2 \\
    &amp; = r_b^2 \big(\left[ \cos(t - t_0)^2 + \sin(t - t_0)^2 \right] + t^2 \times \left[ \cos(t - t_0)^2 + \sin(t - t_0)^2 \right]  \\
    &amp; + \left[ 2t\cos(t - t_0)\sin(t-t_0) - 2t\cos(t - t_0)\sin(t-t_0) \right]\big) \\
    &amp; = r_b^2 (1 - t^2)
\end{align}
\]</span></p>
<p>Thus, for any <span class="math inline">\(r_a\)</span>, we have : <span class="math display">\[
\boxed{t = \sqrt{\left( \frac{r_a}{r_b} \right)^2 - 1}}
\]</span> And <span class="math inline">\(t_a\)</span> denotes the angle from the base radius to the addendum radius.</p>
<p>Also, on the figure <em>Variables for Involute Function</em>, there is two angles <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span>. We can find <span class="math inline">\(\gamma\)</span> given <span class="math inline">\(t\)</span>: <span class="math display">\[
\tan(\delta) = \frac{rt}{r} = t \implies \boxed{\gamma = t - \delta = t - \text{arctan}(t)}
\]</span></p>
<p>Now, we are able to compute the phase between two involute functions. We know that the <em>angle step</em> is equal to <span class="math inline">\(\frac{2 \pi}{z}\)</span> where <span class="math inline">\(z\)</span> is the number of teeth. The angle of thickness of a tooth is equal <span class="math inline">\(\frac{\pi}{z}\)</span> which correspond to the angle of the tooth upper the pitch radius in red. Then the phase is equal to the difference between this angle and the angle of the involute stopping on the pitch angle: <span class="math display">\[
\text{phase} = \frac{\pi}{z} - (t_p - \text{arctan}(t_p)) \quad \text{where} \quad t_p = \sqrt{\left( \frac{r_p}{r_b} \right)^2 - 1}
\]</span></p>
<p>Then the <em>empty</em> part of the profile is made by joining two teeth by passing by the dedendum radius.</p>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> namedtuple</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> manim <span class="im">import</span> <span class="op">*</span> <span class="co"># pip install manim</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> profile(m, z, alpha<span class="op">=</span>radians(<span class="dv">20</span>), ka<span class="op">=</span><span class="dv">1</span>, kf<span class="op">=</span><span class="fl">1.25</span>, interference<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ha <span class="op">=</span> m <span class="op">*</span> ka  <span class="co">#                  addendum height</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    hf <span class="op">=</span> m <span class="op">*</span> kf  <span class="co">#                  dedendum height</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> pi <span class="op">*</span> m  <span class="co">#                   step</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    rp <span class="op">=</span> pitch_radius(m, z) <span class="co">#       pitch radius</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    ra <span class="op">=</span> rp <span class="op">+</span> ha <span class="co">#                  addendum radius</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    rf <span class="op">=</span> rp <span class="op">-</span> hf <span class="co">#                  dedendum radius</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> base_radius(m, z, alpha) <span class="co"># base radius</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    ta <span class="op">=</span> angle_involute(ra, rb) <span class="co">#   addendum angle</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> angle_involute(rp, rb) <span class="co">#   pitch angle</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    duplicate <span class="op">=</span> (</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> obj, angle: obj.copy()</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        .apply_matrix(mat3(X, <span class="op">-</span>Y, Z))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        .rotate_about_origin(angle)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    phase <span class="op">=</span> pi <span class="op">/</span> z <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> (tp <span class="op">-</span> atan2(tp, <span class="dv">1</span>))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Involute</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    side <span class="op">=</span> ParametricFunction(partial(involute, r<span class="op">=</span>rb), t_range<span class="op">=</span>[<span class="dv">0</span>, ta])</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Arc parameters</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    ArcParameters <span class="op">=</span> namedtuple(<span class="st">"ArcParameters"</span>, [<span class="st">"center"</span>, <span class="st">"radius"</span>, <span class="st">"angle"</span>])</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> (rb <span class="op">-</span> rf)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="op">-</span>atan2(r, rf <span class="op">+</span> r)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    arcp <span class="op">=</span> ArcParameters((rf <span class="op">+</span> r) <span class="op">*</span> u(t), r, t)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    arc <span class="op">=</span> Arc(arcp.radius, <span class="op">-</span>pi <span class="op">+</span> arcp.angle, <span class="op">-</span>pi <span class="op">/</span> <span class="dv">2</span>, arc_center<span class="op">=</span>arcp.center)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Joint, top and bottom</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    angle_top <span class="op">=</span> ta <span class="op">-</span> atan2(ta, <span class="dv">1</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    top <span class="op">=</span> Arc(ra, angle_top, phase <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> angle_top)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    joint <span class="op">=</span> Line(arcp.center <span class="op">+</span> arcp.radius <span class="op">*</span> u(<span class="op">-</span><span class="dv">3</span> <span class="op">*</span> pi <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> arcp.angle), rb <span class="op">*</span> X)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> arcp.center <span class="op">+</span> arcp.radius <span class="op">*</span> u(<span class="op">-</span>pi <span class="op">+</span> arcp.angle)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    angle_bottom <span class="op">=</span> anglebt(M, u(<span class="fl">0.5</span> <span class="op">*</span> phase)) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> Line(M, rotation(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> pi <span class="op">/</span> z <span class="op">+</span> angle_bottom) <span class="op">*</span> M)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Patches</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    top_dot <span class="op">=</span> Dot(ra <span class="op">*</span> u(angle_top), radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    side_dot <span class="op">=</span> Dot(rb <span class="op">*</span> X, radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    point <span class="op">=</span> arcp.center <span class="op">+</span> arcp.radius <span class="op">*</span> u(<span class="op">-</span><span class="dv">3</span> <span class="op">*</span> pi <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> arcp.angle)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    joint_dot <span class="op">=</span> Dot(point, radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    bottom_dot <span class="op">=</span> Dot(M, radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    dots <span class="op">=</span> (top_dot, side_dot, joint_dot, bottom_dot)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Duplicated objects</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    duplicated_objs <span class="op">=</span> <span class="bu">map</span>(</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        partial(duplicate, angle<span class="op">=</span>phase), (side, arc, joint) <span class="op">+</span> dots</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> VGroup(</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        side, top, arc, joint, bottom, <span class="op">*</span>duplicated_objs, <span class="op">*</span>dots</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    ).rotate_about_origin(<span class="op">-</span>phase <span class="op">*</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note : for <code>manim</code>, see <a href="https://docs.manim.community/en/stable/installation.html">installation</a></p>
</section>
</section>
<section id="verification-with-the-kinematic-between-a-pinion-and-a-rack" class="level1">
<h1>Verification with the kinematic between a pinion and a rack</h1>
<p>Now, it’s time to check if this profile is correct. Remember that a pinion must work on a rack.</p>
<p>Let’s see the profile of a rack :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rack.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure : Rack profile</figcaption><p></p>
</figure>
</div>
<p>The yellow line denotes the pitch line of the rack. <span class="math inline">\(h_a\)</span> and <span class="math inline">\(h_f\)</span> are computed in the same way as a gear.</p>
<p>The pitch circle of the pinion must roll the pitch line of the rack :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rack_and_gear.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure : Contact between rack and pinion</figcaption><p></p>
</figure>
</div>
<p>Do you see any interference ? Let’s see closer :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><video src="CloseRackOnGear.mp4" class="img-fluid" controls=""><a href="CloseRackOnGear.mp4">Video</a></video></p>
<p></p><figcaption class="figure-caption">Animation : Path of a rack’s tooth on the pinion</figcaption><p></p>
</figure>
</div>
<p>Now, we clearly see that the rack is in interference with the pinion. Then we must find the red function of the previous animation. You can notice that the movement of the rack of a point on the pitch line and center based on the tooth, has a trajectory of the involute function.</p>
<p>Thus, the interference curve is a translated involute function according to the position of the corners of the rack’s tooth. In other words, we define $(t, r, t_0, X, Y) $ as the interference curve such as : <span class="math display">\[
\vec \phi(t, r, t_0, X, Y) = \vec \theta(t, r, t_0) - X \vec u(t - t_0) + Y \vec v(t - t_0)
\]</span> where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are determined based the dimensions of the rack, as the distances <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> from the pitch line dot to one corner.</p>
<p>Based on the figure <em>Rack profile</em>, we can find the following relations : <span class="math display">\[
X = h_a \quad \text{and} \quad Y = \frac{\frac{\pi m}{2} - 2 m k_a \tan(\alpha)}{2}
\]</span></p>
<p>Note we have chosen the left corner of the rack’s tooth.</p>
<p>Next we must find the intersection between <span class="math inline">\(\vec \theta(t_1, r_b, t_{01})\)</span> and <span class="math inline">\(\vec \phi(t_2, r_p, t_{02}, X, Y)\)</span> where <span class="math inline">\(t_1\)</span> and <span class="math inline">\(t_2\)</span> are the unknown variables. The equation to get the intersection is to hard to solve manually. Thus we are going to use the <a href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton’s Method</a> to solve this problem.</p>
<p>The function that we want to optimize is defined as : <span class="math display">\[
\vec f(t_1, t_2) = \vec \theta(t_1, r_b, t_{01}) - \vec \phi(t_2, r_p, t_{02}, X, Y)
\]</span> Note this function is a 2D vector.</p>
<p>Thus, its derivative is the jacobian matrix : <span class="math display">\[
J(t_1, t_2)
= \begin{bmatrix}
\frac{\partial \vec f}{\partial t_1} \cdot \vec x &amp; \frac{\partial \vec f}{\partial t_2} \cdot \vec x \\
\frac{\partial \vec f}{\partial t_1} \cdot \vec y &amp; \frac{\partial \vec f}{\partial t_2} \cdot \vec y
\end{bmatrix}
= \begin{bmatrix}
\vec \theta'(t_1, r_b, t_{01}) &amp; -\vec \phi'(t_2, r_p, t_{02}, X, Y)
\end{bmatrix}
\]</span> To get quickly derivatives of these functions, we start by computing the derivatives of <span class="math inline">\(\vec u(t - t_0)\)</span> and <span class="math inline">\(\vec v(t - t_0)\)</span> : <span class="math display">\[
\vec u'(t - t_0) = \vec v(t - t_0) \quad \text{and} \quad \vec v'(t - t_0) = -\vec u(t - t_0)
\]</span></p>
<p>Thus, we deduce the following derivatives : <span class="math display">\[
\boxed{
    \begin{align}
        \vec \theta'(t_1, r_b, t_{01}) &amp; = r_b t_1 \vec u(t - t_{01}) \\
        \vec \phi'(t_2, r_p, t_{02}, X, Y) &amp; = \vec \theta'(t_2, r_p, t_{02}) - X \vec v(t - t_{02}) - Y \vec u(t - t_{02})
    \end{align}
}
\]</span> Now, all elements are found to be exploited in order to get a new profile.</p>
<section id="code-1" class="level2">
<h2 class="anchored" data-anchor-id="code-1">Code</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> namedtuple</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> manim <span class="im">import</span> <span class="op">*</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> involute(t, r, t0<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r <span class="op">*</span> (u(t <span class="op">-</span> t0) <span class="op">-</span> t <span class="op">*</span> v(t <span class="op">-</span> t0))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interference_curve(t, r, x, y, t0):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> involute(t, r, t0) <span class="op">-</span> x <span class="op">*</span> u(t <span class="op">-</span> t0) <span class="op">+</span> y <span class="op">*</span> v(t <span class="op">-</span> t0)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> derived_involute(t, r, t0):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r <span class="op">*</span> t <span class="op">*</span> u(t <span class="op">-</span> t0)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> derived_interference_curve(t, r, x, y, t0):</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> derived_involute(t, r, t0) <span class="op">-</span> x <span class="op">*</span> v(t <span class="op">-</span> t0) <span class="op">-</span> y <span class="op">*</span> u(t <span class="op">-</span> t0)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> jacobian_involute(rb, rp, x, y, t0):</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">lambda</span> t1, t2: mat3(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        derived_involute(t1, rb, t0), </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span>derived_interference_curve(t2, rp, x, y, t0),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        Z,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> angle_involute(r, rb):</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(r <span class="op">*</span> r <span class="op">/</span> (rb <span class="op">*</span> rb) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> profile(m, z, alpha<span class="op">=</span>radians(<span class="dv">20</span>), ka<span class="op">=</span><span class="dv">1</span>, kf<span class="op">=</span><span class="fl">1.25</span>, interference<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    ha <span class="op">=</span> m <span class="op">*</span> ka  <span class="co">#                  addendum height</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    hf <span class="op">=</span> m <span class="op">*</span> kf  <span class="co">#                  dedendum height</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> pi <span class="op">*</span> m  <span class="co">#                   step</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    rp <span class="op">=</span> pitch_radius(m, z) <span class="co">#       pitch radius</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    ra <span class="op">=</span> rp <span class="op">+</span> ha <span class="co">#                  addendum radius</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    rf <span class="op">=</span> rp <span class="op">-</span> hf <span class="co">#                  dedendum radius</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    rb <span class="op">=</span> base_radius(m, z, alpha) <span class="co"># base radius</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    ta <span class="op">=</span> angle_involute(ra, rb) <span class="co">#   addendum angle</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> angle_involute(rp, rb) <span class="co">#   pitch angle</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    duplicate <span class="op">=</span> (</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> obj, angle: obj.copy()</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        .apply_matrix(mat3(X, <span class="op">-</span>Y, Z))</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        .rotate_about_origin(angle)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    la <span class="op">=</span> rack.addendum_length(m, alpha, ka)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    ts <span class="op">=</span> tp <span class="op">-</span> atan2(tp, <span class="dv">1</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    phase <span class="op">=</span> pi <span class="op">/</span> z <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> (tp <span class="op">-</span> atan2(tp, <span class="dv">1</span>))</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    phase_empty <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> pi <span class="op">/</span> z <span class="op">-</span> phase</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    angle_top <span class="op">=</span> ta <span class="op">-</span> atan2(ta, <span class="dv">1</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    tmin <span class="op">=</span> la <span class="op">*</span> <span class="fl">0.5</span> <span class="op">/</span> rp</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    Functions <span class="op">=</span> namedtuple(<span class="st">"Functions"</span>, [<span class="st">"involute"</span>, <span class="st">"interference"</span>])</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    functions <span class="op">=</span> Functions(</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        partial(involute, r<span class="op">=</span>rb),</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        partial(interference_curve, r<span class="op">=</span>rp, x<span class="op">=</span>ha, y<span class="op">=</span><span class="fl">0.5</span> <span class="op">*</span> la, t0<span class="op">=</span>phase_empty <span class="op">*</span> <span class="fl">0.5</span>),</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Newton method</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="kw">lambda</span> t1, t2: functions.involute(t1) <span class="op">-</span> functions.interference(t2)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    J <span class="op">=</span> jacobian_involute(rb, rp, ha, <span class="fl">0.5</span> <span class="op">*</span> la, phase_empty <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t3 is not used, but exists because 3D vectors</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    t1, t2, t3 <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> ta, <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> ta, <span class="dv">0</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>):</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        t1, t2, t3 <span class="op">=</span> vec3(t1, t2, t3) <span class="op">-</span> inverse(J(t1, t2)) <span class="op">*</span> f(t1, t2)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Involute and interference curve</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    side <span class="op">=</span> ParametricFunction(functions.involute, t_range<span class="op">=</span>[t1, ta])</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    interference <span class="op">=</span> ParametricFunction(functions.interference, t_range<span class="op">=</span>[t2, tmin])</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Top and bottom</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    top <span class="op">=</span> Arc(ra, angle_top, phase <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> angle_top)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> functions.interference(tmin)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    angle_bottom <span class="op">=</span> anglebt(M, u(<span class="fl">0.5</span> <span class="op">*</span> phase)) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> Line(M, rotation(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> pi <span class="op">/</span> z <span class="op">+</span> angle_bottom) <span class="op">*</span> M)</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Patches</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    top_dot <span class="op">=</span> Dot(ra <span class="op">*</span> u(angle_top), radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    interference_dot <span class="op">=</span> Dot(functions.interference(t2), radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    involute_dot <span class="op">=</span> Dot(functions.involute(t1), radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    bottom_dot <span class="op">=</span> Dot(M, radius<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    dots <span class="op">=</span> (top_dot, interference_dot, involute_dot, bottom_dot)</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Duplicated objects</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    duplicated_objs <span class="op">=</span> <span class="bu">map</span>(</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        partial(duplicate, angle<span class="op">=</span>phase), (side, interference) <span class="op">+</span> dots</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> VGroup(</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        side, interference, <span class="op">*</span>duplicated_objs, top, bottom, <span class="op">*</span>dots</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    ).rotate_about_origin(<span class="op">-</span>phase <span class="op">*</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And the gear profile :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gear_with_interference.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure : Gear profile with interference</figcaption><p></p>
</figure>
</div>
<p>Note the closest radius to the pinion’s center is greater than the dedendum radius due to the interference curve.</p>
<p>Let’s see the rack movement now :</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><video src="RackOnGear.mp4" class="img-fluid" controls=""><a href="RackOnGear.mp4">Video</a></video></p>
<p></p><figcaption class="figure-caption">Animation : Rack moving around the pinion</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>That’s it! Now you are able to make a correct spur pinion that follows the kinematic rules between rack and itself.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><video src="GearOnRack.mp4" class="img-fluid" controls=""><a href="GearOnRack.mp4">Video</a></video></p>
<p></p><figcaption class="figure-caption">Animation : Gear and Rack mechanism</figcaption><p></p>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>